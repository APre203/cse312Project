<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Play Page</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="game-area">
            <!-- Your game boundary goes here -->
            game area
            <!--
                What needs to be added: 
                    1. Background
                    2. Mouse detection
                    3. Ball making
                    4. Actual player character (the character will be named as the username OR guest)
            
            -->
            <div class="leaderboard">
                <!-- Leaderboard content goes here -->
                leaderboard
                <!-- 
                    This will be dynamically created and changed no need to do anything here

                 -->
            </div>
        </div>
        <div class="sidebar" id="sidebar">
            <!-- Sidebar content (comments, chat, etc.) goes here -->
            sidebar
            <div id="chat-messages"></div>

            <!-- 
                Users would be able to interact with each other by typing
                Might not need this who knows
             -->
            <div class="chat-form">
                <hr>
                <label>
                    Chat:
                    <input id="chat-text-box" type="text">
                </label>
                <button id="chat-button" onclick="sendChat()">Send</button>
            </div>
        </div>
    </div>
    <script>
        function sendChat() {
            var messageInput = document.getElementById('chat-text-box');
            var message = messageInput.value.trim();
            if (message !== '') {
                var username = 'User'; // You can retrieve username dynamically if you have user authentication
                var data = { username, message };
                fetch('/chat/api', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Content-Type-Options': 'nosniff'
                    },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (response.ok) {
                        addChatMessage(message);
                        messageInput.value = ''; // Clear the input box after sending
                    } else {
                        throw new Error('Failed to send chat message');
                    }
                })
                .catch(error => {
                    console.error(error);
                    // Handle error
                });
            }
        }

        function addChatMessage(message) {
            var sidebar = document.getElementById('sidebar');
            var chatMessages = document.getElementById('chat-messages');
            var username = 'User'; // You can retrieve username dynamically if you have user authentication
            //savechattod(username,message, "test")
            var messageElement = document.createElement('div');
            messageElement.textContent = username + ': ' + message;

            chatMessages.insertBefore(messageElement, chatMessages.firstChild);
            sidebar.scrollTop = 0; // Scroll to top to show the latest message
        }
    </script>
</body>
</html>

